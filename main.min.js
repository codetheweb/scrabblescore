"use strict";function renderScore(e){0==getScore(e)?document.getElementById("score").innerHTML="":document.getElementById("score").innerHTML=getScore(e)*multiplier}function getScore(e){for(var t={a:1,b:3,c:3,d:2,e:1,f:4,g:2,h:4,i:1,j:8,k:5,l:1,m:3,n:1,o:1,p:3,q:10,r:1,s:1,t:1,u:1,v:4,w:4,x:8,y:4,z:10},r=0,n=0;n<e.length;++n){if(void 0!=letterMultipliers.find(function(e){return e.position===n}))var l=letterMultipliers.find(function(e){return e.position===n}).multiplier;else var l=1;r+=t[e.charAt(n)]*l}return r}function multiplyLetter(e,t){return(void 0!=letterMultipliers.find(function(e){return e.position===t})||1==e)&&(removeMultiplier(t),1==e)||void letterMultipliers.push({position:t,multiplier:e})}function removeMultiplier(e){return console.log("Remove"),void 0!=letterMultipliers.find(function(t){return t.position===e})&&letterMultipliers.splice(letterMultipliers.indexOf(letterMultipliers.find(function(t){return t.position===e})),1),!0}function getNodeIndex(e){for(var t=0;e=e.previousSibling;)3==e.nodeType&&/^\s*$/.test(e.data)||t++;return t}var scrabbleWord="",deletedText='<span id="message">start typing...</span>',letterButtons='<div class="letter-buttons"><button class="letter-2x">2X</button><button class="letter-3x">3X</button></div>',multiplier=1,letterMultipliers=[],hiddenTextBox=document.getElementById("invisibleInput");/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&(document.getElementById("message").innerHTML="tap anywhere and start typing...",document.getElementById("container").className="mobile"),hiddenTextBox.onkeyup=function(e){e.preventDefault();var t=document.getElementById("text");e=e||window.event;var r=e.keyCode||e.which;if(8!=r&&46!=r){var n=String.fromCharCode(r);return n=n.toLowerCase().match(/[a-z]/i),null!=n&document.querySelectorAll("#text > .letter-container").length<10&&(""==scrabbleWord&&(t.innerHTML=""),scrabbleWord+=n,t.innerHTML+='<span class="letter-container"><span class="letter">'+n+'</span><span class="letter-score">'+getScore(n[0])+"</span>"+letterButtons+"</span>"),renderScore(scrabbleWord),!0}8==r&&(removeMultiplier(getNodeIndex(document.getElementById("text").lastChild)),t.removeChild(document.getElementById("text").lastChild),scrabbleWord=scrabbleWord.substring(0,scrabbleWord.length-1)),0==document.querySelectorAll("#text > .letter-container").length&&(t.innerHTML=deletedText),renderScore(scrabbleWord)},document.onclick=function(e){hiddenTextBox.focus()},document.querySelector("body").addEventListener("click",function(e){"button"===e.target.tagName.toLowerCase()&&("M2x"==e.target.id||"M3x"==e.target.id?"active"!=e.target.className?("M2x"==e.target.id?(multiplier=2,document.getElementById("M3x").className=""):(multiplier=3,document.getElementById("M2x").className=""),e.target.className="active"):(multiplier=1,e.target.className=""):e.target.className.indexOf("active")==-1?(e.target.className.indexOf("letter-2x")!=-1?(multiplyLetter(2,getNodeIndex(e.target.parentElement.parentElement)),e.target.parentElement.lastChild.className=e.target.parentElement.lastChild.className.replace(/(?:^|\s)active(?!\S)/g,"")):(multiplyLetter(3,getNodeIndex(e.target.parentElement.parentElement)),e.target.parentElement.firstChild.className=e.target.parentElement.firstChild.className.replace(/(?:^|\s)active(?!\S)/g,"")),e.target.className+=" active"):(e.target.className=e.target.className.replace(/(?:^|\s)active(?!\S)/g,""),multiplyLetter(1,getNodeIndex(e.target.parentElement.parentElement))),renderScore(scrabbleWord))});